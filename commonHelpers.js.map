{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\n// заносимо базовий URL в axios\naxios.defaults.baseURL = \"https://pixabay.com/api/\";\n// параметри для пошуку картинок\nconst paramPixabay = {\n    key: \"42515741-a33332df4257bc0cfcc74fb38\",\n    image_type : \"photo\",\n    orientation : \"horizontal\",\n    safesearch: true,\n    per_page: 15,\n}\n\n// функція яка витягує колекцію картинок за запитом\nexport async function getData(query, page) {\n    try {\n        const resp = await axios.get(`?key=${paramPixabay.key}&q=${query}&image_type=${paramPixabay.image_type}&orientation=${paramPixabay.orientation}&safesearch=${paramPixabay.safesearch}&per_page=${paramPixabay.per_page}&page=${page}`);\n        return resp;\n        } catch (error) {\n        console.error(error);\n  }\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nexport const galleryImg = document.querySelector(\".gallery\");\n\n// функція відмальовки розмітки списку картинок\nexport function createMarkup(images) {\n  const htmlListOfGallery = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `<li class=\"gallery-item\">\n         <a class=\"gallery-link\" href=\"${largeImageURL}\">\n         <img class=\"gallery-image\"\n                src=\"${webformatURL}\"\n                alt=\"${tags}\"/> </a>\n        <ul class=\"stat\">\n          <li class=\"detals-stat\">\n           <h2 class=\"description\">Likes</h2>\n           <p class=\"stat-value\">${likes}</p>\n          </li>\n          <li class=\"detals-stat\">\n           <h2 class=\"description\">Views</h2>\n           <p class=\"stat-value\">${views}</p>\n          </li>\n          <li class=\"detals-stat\">\n           <h2 class=\"description\">Comments</h2>\n           <p class=\"stat-value\">${comments}</p>\n          </li>\n          <li class=\"detals-stat\">\n           <h2 class=\"description\">Downloads</h2>\n           <p class=\"stat-value\">${downloads}</p>\n          </li>\n        </ul>\n        </li>`\n    ).join('');\n  \n  // відмальовуємо за раз все що сформували\n  galleryImg.insertAdjacentHTML(\"beforeend\", htmlListOfGallery);\n    \n  lightbox.refresh();\n}\n  \n// відкривашка великих красивих картинок\n  const lightbox = new SimpleLightbox('.gallery-item a', {\n            captionsData: \"alt\",\n            captionPosition: \"bottom\",\n            captionDelay: 250,\n  });","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n// імпорти функцій і елементів з інших js-файлів\nimport { getData } from \"./js/pixabay-api.js\";\nimport { createMarkup, galleryImg } from \"./js/render-functions.js\";\n\nconst ourForm = document.querySelector(\".form\");\nconst buttonSearch = document.querySelector(\".button-search\");\nconst loader = document.querySelector(\".loader\");\nconst buttonLoadMore = document.querySelector(\".button-load-more\");\n\nconst query = \"\";\nconst page = 1;\nconst perPage = 15;\nlet current_page;\nlet current_query;\n\n// підслуховувач на відправку\nourForm.addEventListener(\"submit\", getPhoto);\n\n// функція яка виконується в підслуховувачі\nfunction getPhoto(event) {\n    // забороняємо браузеру виконувати стандартні сценарії\n    event.preventDefault();\n    // зчитуємо які дані ввели в поле інпут\n    const query = event.target.elements.search.value.trim();\n    // перевірка на порожнє поле\n    if (!query) {\n        iziToast.warning({\n                title: \"Look at me\",\n                message: `Ви не ввели що треба шукати`,\n                messageColor: 'black',\n                messageSize: '16',\n                backgroundColor: 'orange',\n                theme: 'dark',\n                position: 'topRight',\n        });\n        return;\n    }\n    // перевірка чи введено новий запит в форму пошуку, якщо так то сторінка обнуляється і виводяться нові картинки\n    else if (query !== current_query) {\n        galleryImg.innerHTML = \"\";\n    }\n    // якщо введено такий самий запит як і попередній - виходить відповідне повідомлення\n    else {\n        iziToast.warning({\n                title: \"Look at me\",\n                message: `Ви зробили запит як і попередній, використовуйте кнопку \"Load more\" щоб завантажити більше ${current_query}`,\n                messageColor: 'black',\n                messageSize: '16',\n                backgroundColor: 'pink',\n                theme: 'dark',\n                position: 'topRight',\n        });\n        return;\n    };\n\n    buttonSearch.disabled = false;\n    // викликаємо функцію запиту картинок і заносимо її в змінну-проміс\n    const resp = getData(query, page);\n    resp\n        .then(resp => {\n            // якщо проміс повернув помилку про стан http\n            if (!resp.statusText === \"Ok\") {\n                throw new Error(resp.status);\n            }\n            // перевірка чи знайдено щось було за нашим запитом, хоча б один запис, якщо ні \n            // - сторінка обнуляється + повідомлення\n            else if (resp.data.hits.length === 0) {\n                    galleryImg.innerHTML = \"\";\n                    iziToast.error({\n                    title: 'Error',\n                    message: `Sorry, there are no images matching your search query. Please try again!`,\n                    messageColor: 'white',\n                    messageSize: '16',\n                    backgroundColor: 'red',\n                    theme: 'dark',\n                    position: 'topRight',\n                    });\n                    buttonLoadMore.style.display = \"none\";\n                   return;\n            }\n            // якщо все добре і щось знайшлось, викликаємо функцію відмальовки карток з картинками\n            else {\n                createMarkup(resp.data.hits);\n                // перевірка чи знайшло менше-дорівнює картинок ніж нам потрібно (15 штук)\n                if (resp.data.totalHits <= perPage) {\n                    // кнопка Load more не з'являється\n                    buttonLoadMore.style.display = \"none\";\n                    // повідомлення - що це всі картинки що були знайдені\n                    iziToast.warning({\n                    title: 'Ups',\n                    message: `We're sorry, but you've reached the end of search results`,\n                    messageColor: 'black',\n                    messageSize: '16',\n                    backgroundColor: 'lightblue',\n                    theme: 'dark',\n                    position: 'bottomRight',\n                    });\n                } else {\n                    // якщо знайшло більше ніж 15 - кнопка Load more активується\n                    buttonLoadMore.style.display = \"block\";\n                }\n                      }\n        })\n        .catch(error => {\n                // ловимо помилки\n                return iziToast.error({\n                title: 'Error',\n                message: `${error}`,\n                messageColor: 'white',\n                messageSize: '16',\n                backgroundColor: 'red',\n                theme: 'dark',\n                position: 'topRight',\n                });\n            })\n        .finally(() =>{\n            // в будь-якому варіанті обнуляємо поле інпут від старого запиту\n            ourForm.reset();\n        });\n// запам'ятовуємо поточний запит і що стартонули зі сторінки 1\n    current_query = query;\n    current_page = page;\n// робимо кнопку Load more безкласною\n    buttonLoadMore.classList.remove('is-hidden');\n};\n\n// вішаємо слухача на натискання кнопки Load more\nbuttonLoadMore.addEventListener('click', loadMorePictures);\n\n// функція яка буде виконуватись при натисканні на кнопку Load more\nfunction loadMorePictures() {\n    // знімаємо з крутелика клас is-hidden і робимо видими\n    loader.classList.remove('is-hidden');  \n    loader.style.display = 'block';\n    // збільшуємо лічильник поточних сторінок\n    current_page++;\n    // отримуємо продовження масиву даних з АПІ\n    const resp = getData(current_query, current_page);\n    resp\n        .then(resp => {\n            // вираховуємо загальну кількість сторінок зі знайденими картинками\n            // округлюємо до цілого числа в більшу сторону\n            // загальну кількість знайдених картинок / облікові 15 на сторінку\n            const totalPage = Math.ceil(resp.data.totalHits / perPage);\n            // вираховуємо висоту рядка з картинками\n            const heightOfImg = galleryImg.firstElementChild.getBoundingClientRect().height;\n            // область видимості вікна прокручується на 2 висоти картинки згідно умови ТЗ\n            window.scrollBy({ top: heightOfImg * 2, behavior: 'smooth' });\n            // перевірка чи не дібрались ми до кінця колекції картинок\n            if (current_page < totalPage) {\n                createMarkup(resp.data.hits);\n            }\n            // якщо таки дійшли до кінця - виводимо залишок картинок, ховаємо кнопку Load more і виводимо попередження\n            else {\n                createMarkup(resp.data.hits);\n                buttonLoadMore.style.display = \"none\";\n                iziToast.warning({\n                title: 'Ups',\n                message: `We're sorry, but you've reached the end of search results`,\n                messageColor: 'black',\n                messageSize: '16',\n                backgroundColor: 'lightgreen',\n                theme: 'dark',\n                position: 'bottomRight',\n                });\n            }\n        })\n        .catch(error => {\n                // ловимо помилки\n                return iziToast.error({\n                title: 'Error',\n                message: `${error}`,\n                messageColor: 'white',\n                messageSize: '16',\n                backgroundColor: 'red',\n                theme: 'dark',\n                position: 'topRight',\n                });\n            });\n    //  повинні прокручувати сторінку поки не побачимо кнопку внизу\n    buttonLoadMore.scrollIntoView({ block: \"end\" });\n    // ховаємо крутелика на кнопці\n    loader.style.display = 'none';\n    loader.classList.add(\"is-hidden\");\n}"],"names":["axios","paramPixabay","getData","query","page","error","galleryImg","createMarkup","images","htmlListOfGallery","webformatURL","largeImageURL","tags","likes","views","comments","downloads","lightbox","SimpleLightbox","ourForm","buttonSearch","loader","buttonLoadMore","perPage","current_page","current_query","getPhoto","event","iziToast","resp","loadMorePictures","totalPage","heightOfImg"],"mappings":"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"}